<!DOCTYPE html><!DOCTYPE html><!DOCTYPE html>

<html lang="vi">

<head><html lang="vi"><html lang="vi">

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0"><head>

    <title>Trợ lý ảo</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>">    <meta charset="UTF-8">  <meta charset="UTF-8" />

    <style>

        body {    <meta name="viewport" content="width=device-width, initial-scale=1.0">  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

            font-family: Arial, sans-serif;

            background: linear-gradient(to right, #e0f7fa, #e1bee7);    <title>AI Chat</title>  <title>Trợ lý ảo</title>

            margin: 0;

            padding: 0;    <style>  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>" />

            display: flex;

            flex-direction: column;        body {  <style>

            height: 100vh;

        }            margin: 0;    body {



        #topbar {            padding: 20px;      font-family: Arial, sans-serif;

            display: flex;

            align-items: center;            font-family: Arial, sans-serif;      background: linear-gradient(to right, #e0f7fa, #e1bee7);

            padding: 10px 20px;

            background-color: #ffffffcc;            background-color: #f0f0f0;      margin: 0;

            border-bottom: 1px solid #ccc;

            position: sticky;        }      padding: 0;

            top: 0;

            z-index: 10;      display: flex;

        }

        #chat-container {      flex-direction: column;

        .logo {

            font-size: 28px;            max-width: 800px;      height: 100vh;

            font-weight: bold;

            margin-right: 10px;            margin: 0 auto;    }

            color: #0078d4;

            font-family: system-ui, sans-serif;            background-color: white;    header {

        }

            border-radius: 10px;      display: flex;

        .title {

            font-size: 22px;            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);      align-items: center;

            font-weight: bold;

            color: #333;            padding: 20px;      gap: 10px;

        }

        }      padding: 10px 20px;

        nav {

            margin-left: auto;      background-color: #fff;

        }

        #chat-history {      border-bottom: 1px solid #ccc;

        nav ul {

            list-style: none;            height: 400px;    }

            display: flex;

            gap: 2rem;            overflow-y: auto;    header img {

            margin: 0;

            padding: 0;            border: 1px solid #ccc;      width: 24px;

        }

            padding: 10px;      height: 24px;

        nav a {

            color: #1e1e1e;            margin-bottom: 20px;    }

            font-weight: bold;

            text-decoration: none;            white-space: pre-wrap;    header h1 {

        }

        }      font-size: 20px;

        nav a:hover {

            color: #0078d4;      margin: 0;

        }

        #input-container {      color: #333;

        #chat {

            flex: 1;            display: flex;    }

            padding: 20px;

            overflow-y: auto;            gap: 10px;    header a {

        }

        }      margin-left: auto;

        .message {

            max-width: 70%;      font-size: 14px;

            margin-bottom: 16px;

            padding: 10px 15px;        #user-input {      color: #0078d4;

            border-radius: 15px;

            white-space: pre-wrap;            flex-grow: 1;      text-decoration: none;

        }

            padding: 10px;    }

        .user {

            background-color: #0078d4;            border: 1px solid #ccc;    #chat {

            color: white;

            align-self: flex-end;            border-radius: 5px;      flex: 1;

            border-bottom-right-radius: 0;

            margin-left: auto;            font-size: 16px;      padding: 20px;

        }

        }      overflow-y: auto;

        .bot {

            background-color: #f1f1f1;    }

            color: #333;

            align-self: flex-start;        #send-button {    .message {

            border-bottom-left-radius: 0;

        }            padding: 10px 20px;      max-width: 70%;



        .input-area {            background-color: #007bff;      margin-bottom: 16px;

            padding: 10px;

            background: #fff;            color: white;      padding: 10px 15px;

            border-top: 1px solid #ccc;

        }            border: none;      border-radius: 15px;



        .input-area > div {            border-radius: 5px;      white-space: pre-wrap;

            display: flex;

            gap: 10px;            cursor: pointer;    }

            align-items: center;

            max-width: 1200px;            font-size: 16px;    .user {

            margin: 0 auto;

        }        }      background-color: #0078d4;



        textarea {      color: white;

            flex: 1;

            resize: none;        #send-button:hover {      align-self: flex-end;

            padding: 10px;

            font-size: 16px;            background-color: #0056b3;      border-bottom-right-radius: 0;

            border-radius: 8px;

            border: 1px solid #ccc;        }    }

            font-family: inherit;

        }    .bot {



        button {        .user-message {      background-color: #f1f1f1;

            padding: 10px 20px;

            font-size: 16px;            color: #007bff;      color: #333;

            background-color: #0078d4;

            color: white;            margin-bottom: 10px;      align-self: flex-start;

            border: none;

            border-radius: 8px;        }      border-bottom-left-radius: 0;

            cursor: pointer;

            transition: background-color 0.2s;    }

        }

        .ai-message {    .input-area {

        button:hover {

            background-color: #006cbd;            color: #28a745;      padding: 10px;

        }

            margin-bottom: 10px;      background: #fff;

        #searchToggle.active {

            background-color: #004578;        }      border-top: 1px solid #ccc;

        }

    }

        #placeholder {

            display: flex;        #thinking-indicator {    .input-area > div {

            justify-content: center;

            align-items: center;            display: none;      display: flex;

            height: 100px;

            text-align: center;            color: #666;      gap: 10px;

            color: #666;

            margin-top: 40px;            margin-top: 10px;      align-items: center;

            font-style: italic;

            font-size: 40px;        }    }

            font-weight: bold;

            opacity: 1;    </style>    textarea {

            transition: opacity 0.8s ease;

        }</head>      flex: 1;



        #typing-indicator {<body>      resize: none;

            font-style: italic;

            color: #666;    <div id="chat-container">      padding: 10px;

        }

    </style>        <div id="chat-history">      font-size: 16px;

</head>

<body>            <!-- Tin nhắn sẽ được hiển thị ở đây -->      border-radius: 8px;

    <header id="topbar">

        <div class="logo" aria-hidden="true">G</div>        </div>      border: 1px solid #ccc;

        <div class="title">Trợ lý ảo</div>

        <nav>        <div id="input-container">    }

            <ul>

                <li><a href="dksd.html">Điều khoản sử dụng</a></li>            <input type="text" id="user-input" placeholder="Nhập tin nhắn của bạn...">    button {

                <li><a href="csbm.html">Chính sách bảo mật</a></li>

            </ul>            <button id="send-button">Gửi</button>      padding: 10px 20px;

        </nav>

    </header>        </div>      font-size: 16px;



    <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>        <div id="thinking-indicator">AI đang suy nghĩ...</div>      background-color: #0078d4;

    <div id="chat"></div>

    <div class="input-area">    </div>      color: white;

        <div>

            <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>      border: none;

            <textarea id="question" placeholder="Nhập tin nhắn..." rows="1"></textarea>

            <button onclick="sendMessage()">Gửi</button>    <script>      border-radius: 8px;

        </div>

    </div>        const chatHistory = document.getElementById('chat-history');      cursor: pointer;



    <script>        const userInput = document.getElementById('user-input');    }

        const chat = document.getElementById("chat");

        const input = document.getElementById("question");        const sendButton = document.getElementById('send-button');    #searchToggle.active {

        const searchToggle = document.getElementById("searchToggle");

        let internetMode = false;        const thinkingIndicator = document.getElementById('thinking-indicator');      background-color: #000;



        // Auto-resize textarea as user types      color: #fff;

        input.addEventListener('input', function() {

            this.style.height = 'auto';        let isProcessing = false;    }

            this.style.height = Math.min(this.scrollHeight, 150) + 'px';

        });    #placeholder {



        searchToggle.addEventListener("click", () => {        async function sendMessage() {      display: flex;

            internetMode = !internetMode;

            searchToggle.classList.toggle("active", internetMode);            if (isProcessing || !userInput.value.trim()) return;      justify-content: center;

        });

      align-items: center;

        input.addEventListener("keydown", function(event) {

            if (event.key === "Enter" && !event.shiftKey) {            const userMessage = userInput.value.trim();      height: 100px;

                event.preventDefault();

                sendMessage();            appendMessage('Người dùng: ' + userMessage, 'user-message');      text-align: center;

            }

        });            userInput.value = '';      color: #666;



        async function searchGoogle(question) {      margin-top: 40px;

            const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";

            const cx = "f5f83897432f243aa";            isProcessing = true;      font-style: italic;

            const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;

            thinkingIndicator.style.display = 'block';      font-size: 40px;

            try {

                const res = await fetch(url);      font-weight: bold;

                const data = await res.json();

                if (data.items && data.items.length > 0) {            try {      opacity: 1;

                    return data.items.slice(0, 3).map(item =>

                        `• ${item.title}\n${item.snippet}\n${item.link}`                const response = await fetch('https://aichat-v6nq.onrender.com/chat', {      transition: opacity 0.8s ease;

                    ).join("\n\n");

                } else {                    method: 'POST',    }

                    return "Không tìm thấy thông tin trên Google.";

                }                    headers: {    #topbar {

            } catch (err) {

                return "🛑 Không thể truy cập Google Search lúc này.";                        'Content-Type': 'application/json'  display: flex;

            }

        }                    },  align-items: center;



        async function sendMessage() {                    body: JSON.stringify({ message: userMessage })  padding: 10px 20px;

            const question = input.value.trim();

            if (!question) return;                });  background-color: #ffffffcc;



            addMessage(question, "user");  border-bottom: 1px solid #ccc;

            document.getElementById("placeholder").style.opacity = "0";

            input.value = "";                const data = await response.json();  position: sticky;

            input.style.height = 'auto';

                appendMessage('AI: ' + data.response, 'ai-message');  top: 0;

            showTypingIndicator();

            } catch (error) {  z-index: 10;

            const shouldSearch = internetMode;

            let webInfo = "";                console.error('Error:', error);}



            if (shouldSearch) {                appendMessage('AI: Xin lỗi, đã có lỗi xảy ra. Vui lòng thử lại sau.', 'ai-message');

                updateTypingIndicator("Đang tìm kiếm trên Google...");

                webInfo = await searchGoogle(question);            }.logo {

                addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");

            }  font-size: 28px;



            try {            isProcessing = false;  font-weight: bold;

                const response = await fetch("https://aichat-v6nq.onrender.com/chat", {

                    method: "POST",            thinkingIndicator.style.display = 'none';  margin-right: 10px;

                    headers: { "Content-Type": "application/json" },

                    body: JSON.stringify({        }  color: #0078d4;

                        message: shouldSearch 

                            ? `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời dựa trên thông tin từ Google ở trên nếu liên quan.`  font-family: system-ui, sans-serif;

                            : question

                    })        function appendMessage(message, className) {}

                });

            const messageElement = document.createElement('div');

                if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

            messageElement.textContent = message;.title {

                const result = await response.json();

                hideTypingIndicator();            messageElement.className = className;  font-size: 22px;

                addMessage(result.response, "bot");

            } catch (error) {            chatHistory.appendChild(messageElement);  font-weight: bold;

                console.error("🛑 Lỗi khi gọi API:", error);

                hideTypingIndicator();            chatHistory.scrollTop = chatHistory.scrollHeight;  color: #333;

                addMessage("🛑 Có lỗi xảy ra: " + error.message, "bot");

            }        }}

        }

nav{

        function addMessage(text, sender) {

            const msg = document.createElement("div");        sendButton.addEventListener('click', sendMessage);  letter-spacing: 1px;

            msg.className = `message ${sender}`;

            chat.appendChild(msg);        userInput.addEventListener('keypress', (e) => {  padding: 1rem;



            if (sender === "bot") {            if (e.key === 'Enter') {}

                typeText(msg, text);

            } else {                sendMessage();

                msg.textContent = text;

            }            }nav ul{



            chat.scrollTop = chat.scrollHeight;        });  list-style: none;

        }

    </script>  display: flex;

        function typeText(element, text, speed = 5) {

            let i = 0;</body>  justify-content: center;

            const interval = setInterval(() => {

                if (i < text.length) {</html>  gap: 2rem;

                    element.textContent += text.charAt(i);}

                    i++;

                    chat.scrollTop = chat.scrollHeight;nav a{

                } else {  color: #1e1e1e;

                    clearInterval(interval);  font-weight: bold;

                }}

            }, speed);

        }nav a:hover{

  color: #ffd700;

        function showTypingIndicator() {}

            const typing = document.createElement("div");

            typing.id = "typing-indicator";  </style>

            typing.className = "message bot";</head>

            typing.textContent = "Trợ lý ảo đang gõ...";<body>

            chat.appendChild(typing);  <header id="topbar">

            chat.scrollTop = chat.scrollHeight;  <div class="logo" aria-hidden="true">G</div>

        }  <div class="title">Trợ lý ảo</div>

  <nav>

        function updateTypingIndicator(text) {    <ul>

            const typing = document.getElementById("typing-indicator");         <li><a href="dksd.html">Điều khoản sử dụng</a></li>

            if (typing) typing.textContent = text;         <li><a href="csbm.html">Chính sách bảo mật</a></li>

        }    </ul>

  </nav>

        function hideTypingIndicator() {</header>

            const typing = document.getElementById("typing-indicator");

            if (typing) typing.remove();  <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>

        }  <div id="chat"></div>

    </script>  <div class="input-area">

</body>    <div>

</html>      <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>
      <textarea id="question" placeholder="Nhập tin nhắn..."></textarea>
      <button onclick="sendMessage()">Gửi</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("question");
    const searchToggle = document.getElementById("searchToggle");
    let internetMode = false;

    searchToggle.addEventListener("click", () => {
      internetMode = !internetMode;
      searchToggle.classList.toggle("active", internetMode);
    });

    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    });

    async function searchGoogle(question) {
      const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";
      const cx = "f5f83897432f243aa";
      const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.items && data.items.length > 0) {
          return data.items.slice(0, 3).map(item =>
            `â€¢ ${item.title}\n${item.snippet}\n${item.link}`
          ).join("\n\n");
        } else {
          return "Không tìm thấy thông tin trên Google.";
        }
      } catch (err) {
        return "🛑 Không thể truy cập Google Search lúc này.";
      }
    }

    async function sendMessage() {
      const question = input.value.trim();
      if (!question) return;

      addMessage(question, "user");
      document.getElementById("placeholder").style.opacity = "0";
      input.value = "";

      showTypingIndicator();

      const shouldSearch = internetMode;
      let webInfo = "";

      if (shouldSearch) {
        updateTypingIndicator("Đang tìm kiếm trên Google...");
        webInfo = await searchGoogle(question);
        addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");
      }

      const messages = [
        {
          role: "system",
          content: "Bạn là trợ lý AI thân thiện, nói chuyện tự nhiên như người thật. Ưu tiên dùng thông tin từ Google nếu có."
        },
        {
          role: "user",
          content: `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời chính xác dựa trên thông tin từ Google ở trên. Nếu có tên người, chức vụ hoặc ngày tháng, hãy trích dẫn lại.`
        }
      ];

      try {
        const response = await fetch("https://website-chat-8hyf.onrender.com/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ messages })
        });

        if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

        const result = await response.json();
        const reply = result.choices?.[0]?.message?.content || "Không có phản hồi từ Groq.";

        hideTypingIndicator();
        addMessage(reply, "bot");
      } catch (error) {
        console.error("🛑 Lỗi khi gọi API:", error);
        hideTypingIndicator();
        addMessage("🛑 Có lỗi xảy ra khi gọi Groq: " + error.message, "bot");
      }
    }

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.className = `message ${sender}`;
      chat.appendChild(msg);

      if (sender === "bot") {
        typeText(msg, text);
      } else {
        msg.textContent = text;
      }

      chat.scrollTop = chat.scrollHeight;
    }

    function typeText(element, text, speed = 5) {
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          chat.scrollTop = chat.scrollHeight;
        } else {
          clearInterval(interval);
        }
      }, speed);
    }

    function showTypingIndicator() {
      const typing = document.createElement("div");
      typing.id = "typing-indicator";
      typing.className = "message bot";
      typing.textContent = "Trợ lý ảo đang gõ...";
      chat.appendChild(typing);
      chat.scrollTop = chat.scrollHeight;
    }

    function updateTypingIndicator(text) {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.textContent = text;
    }

    function hideTypingIndicator() {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.remove();
    }
  </script>
</body>
</html>
