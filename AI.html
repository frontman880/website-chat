<!DOCTYPE html><!DOCTYPE html>

<html lang="vi"><html lang="vi">

<head><head>

    <meta charset="UTF-8">  <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>AI Chat</title>  <title>Trợ lý ảo</title>

    <style>  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>" />

        body {  <style>

            margin: 0;    body {

            padding: 20px;      font-family: Arial, sans-serif;

            font-family: Arial, sans-serif;      background: linear-gradient(to right, #e0f7fa, #e1bee7);

            background-color: #f0f0f0;      margin: 0;

        }      padding: 0;

      display: flex;

        #chat-container {      flex-direction: column;

            max-width: 800px;      height: 100vh;

            margin: 0 auto;    }

            background-color: white;    header {

            border-radius: 10px;      display: flex;

            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);      align-items: center;

            padding: 20px;      gap: 10px;

        }      padding: 10px 20px;

      background-color: #fff;

        #chat-history {      border-bottom: 1px solid #ccc;

            height: 400px;    }

            overflow-y: auto;    header img {

            border: 1px solid #ccc;      width: 24px;

            padding: 10px;      height: 24px;

            margin-bottom: 20px;    }

            white-space: pre-wrap;    header h1 {

        }      font-size: 20px;

      margin: 0;

        #input-container {      color: #333;

            display: flex;    }

            gap: 10px;    header a {

        }      margin-left: auto;

      font-size: 14px;

        #user-input {      color: #0078d4;

            flex-grow: 1;      text-decoration: none;

            padding: 10px;    }

            border: 1px solid #ccc;    #chat {

            border-radius: 5px;      flex: 1;

            font-size: 16px;      padding: 20px;

        }      overflow-y: auto;

    }

        #send-button {    .message {

            padding: 10px 20px;      max-width: 70%;

            background-color: #007bff;      margin-bottom: 16px;

            color: white;      padding: 10px 15px;

            border: none;      border-radius: 15px;

            border-radius: 5px;      white-space: pre-wrap;

            cursor: pointer;    }

            font-size: 16px;    .user {

        }      background-color: #0078d4;

      color: white;

        #send-button:hover {      align-self: flex-end;

            background-color: #0056b3;      border-bottom-right-radius: 0;

        }    }

    .bot {

        .user-message {      background-color: #f1f1f1;

            color: #007bff;      color: #333;

            margin-bottom: 10px;      align-self: flex-start;

        }      border-bottom-left-radius: 0;

    }

        .ai-message {    .input-area {

            color: #28a745;      padding: 10px;

            margin-bottom: 10px;      background: #fff;

        }      border-top: 1px solid #ccc;

    }

        #thinking-indicator {    .input-area > div {

            display: none;      display: flex;

            color: #666;      gap: 10px;

            margin-top: 10px;      align-items: center;

        }    }

    </style>    textarea {

</head>      flex: 1;

<body>      resize: none;

    <div id="chat-container">      padding: 10px;

        <div id="chat-history">      font-size: 16px;

            <!-- Tin nhắn sẽ được hiển thị ở đây -->      border-radius: 8px;

        </div>      border: 1px solid #ccc;

        <div id="input-container">    }

            <input type="text" id="user-input" placeholder="Nhập tin nhắn của bạn...">    button {

            <button id="send-button">Gửi</button>      padding: 10px 20px;

        </div>      font-size: 16px;

        <div id="thinking-indicator">AI đang suy nghĩ...</div>      background-color: #0078d4;

    </div>      color: white;

      border: none;

    <script>      border-radius: 8px;

        const chatHistory = document.getElementById('chat-history');      cursor: pointer;

        const userInput = document.getElementById('user-input');    }

        const sendButton = document.getElementById('send-button');    #searchToggle.active {

        const thinkingIndicator = document.getElementById('thinking-indicator');      background-color: #000;

      color: #fff;

        let isProcessing = false;    }

    #placeholder {

        async function sendMessage() {      display: flex;

            if (isProcessing || !userInput.value.trim()) return;      justify-content: center;

      align-items: center;

            const userMessage = userInput.value.trim();      height: 100px;

            appendMessage('Người dùng: ' + userMessage, 'user-message');      text-align: center;

            userInput.value = '';      color: #666;

      margin-top: 40px;

            isProcessing = true;      font-style: italic;

            thinkingIndicator.style.display = 'block';      font-size: 40px;

      font-weight: bold;

            try {      opacity: 1;

                const response = await fetch('https://aichat-v6nq.onrender.com/chat', {      transition: opacity 0.8s ease;

                    method: 'POST',    }

                    headers: {    #topbar {

                        'Content-Type': 'application/json'  display: flex;

                    },  align-items: center;

                    body: JSON.stringify({ message: userMessage })  padding: 10px 20px;

                });  background-color: #ffffffcc;

  border-bottom: 1px solid #ccc;

                const data = await response.json();  position: sticky;

                appendMessage('AI: ' + data.response, 'ai-message');  top: 0;

            } catch (error) {  z-index: 10;

                console.error('Error:', error);}

                appendMessage('AI: Xin lỗi, đã có lỗi xảy ra. Vui lòng thử lại sau.', 'ai-message');

            }.logo {

  font-size: 28px;

            isProcessing = false;  font-weight: bold;

            thinkingIndicator.style.display = 'none';  margin-right: 10px;

        }  color: #0078d4;

  font-family: system-ui, sans-serif;

        function appendMessage(message, className) {}

            const messageElement = document.createElement('div');

            messageElement.textContent = message;.title {

            messageElement.className = className;  font-size: 22px;

            chatHistory.appendChild(messageElement);  font-weight: bold;

            chatHistory.scrollTop = chatHistory.scrollHeight;  color: #333;

        }}

nav{

        sendButton.addEventListener('click', sendMessage);  letter-spacing: 1px;

        userInput.addEventListener('keypress', (e) => {  padding: 1rem;

            if (e.key === 'Enter') {}

                sendMessage();

            }nav ul{

        });  list-style: none;

    </script>  display: flex;

</body>  justify-content: center;

</html>  gap: 2rem;
}

nav a{
  color: #1e1e1e;
  font-weight: bold;
}

nav a:hover{
  color: #ffd700;
}

  </style>
</head>
<body>
  <header id="topbar">
  <div class="logo" aria-hidden="true">G</div>
  <div class="title">Trợ lý ảo</div>
  <nav>
    <ul>
         <li><a href="dksd.html">Điều khoản sử dụng</a></li>
         <li><a href="csbm.html">Chính sách bảo mật</a></li>
    </ul>
  </nav>
</header>

  <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>
  <div id="chat"></div>
  <div class="input-area">
    <div>
      <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>
      <textarea id="question" placeholder="Nhập tin nhắn..."></textarea>
      <button onclick="sendMessage()">Gửi</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("question");
    const searchToggle = document.getElementById("searchToggle");
    let internetMode = false;

    searchToggle.addEventListener("click", () => {
      internetMode = !internetMode;
      searchToggle.classList.toggle("active", internetMode);
    });

    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    });

    async function searchGoogle(question) {
      const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";
      const cx = "f5f83897432f243aa";
      const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.items && data.items.length > 0) {
          return data.items.slice(0, 3).map(item =>
            `â€¢ ${item.title}\n${item.snippet}\n${item.link}`
          ).join("\n\n");
        } else {
          return "Không tìm thấy thông tin trên Google.";
        }
      } catch (err) {
        return "🛑 Không thể truy cập Google Search lúc này.";
      }
    }

    async function sendMessage() {
      const question = input.value.trim();
      if (!question) return;

      addMessage(question, "user");
      document.getElementById("placeholder").style.opacity = "0";
      input.value = "";

      showTypingIndicator();

      const shouldSearch = internetMode;
      let webInfo = "";

      if (shouldSearch) {
        updateTypingIndicator("Đang tìm kiếm trên Google...");
        webInfo = await searchGoogle(question);
        addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");
      }

      const messages = [
        {
          role: "system",
          content: "Bạn là trợ lý AI thân thiện, nói chuyện tự nhiên như người thật. Ưu tiên dùng thông tin từ Google nếu có."
        },
        {
          role: "user",
          content: `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời chính xác dựa trên thông tin từ Google ở trên. Nếu có tên người, chức vụ hoặc ngày tháng, hãy trích dẫn lại.`
        }
      ];

      try {
        const response = await fetch("https://website-chat-8hyf.onrender.com/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ messages })
        });

        if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

        const result = await response.json();
        const reply = result.choices?.[0]?.message?.content || "Không có phản hồi từ Groq.";

        hideTypingIndicator();
        addMessage(reply, "bot");
      } catch (error) {
        console.error("🛑 Lỗi khi gọi API:", error);
        hideTypingIndicator();
        addMessage("🛑 Có lỗi xảy ra khi gọi Groq: " + error.message, "bot");
      }
    }

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.className = `message ${sender}`;
      chat.appendChild(msg);

      if (sender === "bot") {
        typeText(msg, text);
      } else {
        msg.textContent = text;
      }

      chat.scrollTop = chat.scrollHeight;
    }

    function typeText(element, text, speed = 5) {
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          chat.scrollTop = chat.scrollHeight;
        } else {
          clearInterval(interval);
        }
      }, speed);
    }

    function showTypingIndicator() {
      const typing = document.createElement("div");
      typing.id = "typing-indicator";
      typing.className = "message bot";
      typing.textContent = "Trợ lý ảo đang gõ...";
      chat.appendChild(typing);
      chat.scrollTop = chat.scrollHeight;
    }

    function updateTypingIndicator(text) {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.textContent = text;
    }

    function hideTypingIndicator() {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.remove();
    }
  </script>
</body>
</html>
