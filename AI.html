<!DOCTYPE html><!DOCTYPE html><!DOCTYPE html><!DOCTYPE html><!DOCTYPE html>

<html lang="vi">

<head><html lang="vi">

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0"><head><html lang="vi">

    <title>Trợ lý ảo</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>">    <meta charset="UTF-8">

    <style>

        * {    <meta name="viewport" content="width=device-width, initial-scale=1.0"><head><html lang="vi"><html lang="vi">

            box-sizing: border-box;

            margin: 0;    <title>Trợ lý ảo</title>

            padding: 0;

        }    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>">    <meta charset="UTF-8">



        body {    <style>

            font-family: system-ui, -apple-system, Arial, sans-serif;

            background: linear-gradient(135deg, #e0f7fa 0%, #e1bee7 100%);        body {    <meta name="viewport" content="width=device-width, initial-scale=1.0"><head>

            min-height: 100vh;

            display: flex;            font-family: Arial, sans-serif;

            flex-direction: column;

        }            background: linear-gradient(to right, #e0f7fa, #e1bee7);    <title>Trợ lý ảo</title>



        #topbar {            margin: 0;

            background: rgba(255, 255, 255, 0.9);

            padding: 1rem;            padding: 0;    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>">    <meta charset="UTF-8">  <meta charset="UTF-8" />

            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

            display: flex;            display: flex;

            align-items: center;

            gap: 1rem;            flex-direction: column;    <style>

            position: sticky;

            top: 0;            height: 100vh;

            z-index: 100;

        }        }        body {    <meta name="viewport" content="width=device-width, initial-scale=1.0">  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />



        .logo {

            font-size: 1.75rem;

            font-weight: bold;        #topbar {            font-family: Arial, sans-serif;

            color: #0078d4;

        }            display: flex;



        .title {            align-items: center;            background: linear-gradient(to right, #e0f7fa, #e1bee7);    <title>AI Chat</title>  <title>Trợ lý ảo</title>

            font-size: 1.25rem;

            font-weight: 600;            padding: 10px 20px;

            color: #333;

        }            background-color: #ffffffcc;            margin: 0;



        nav {            border-bottom: 1px solid #ccc;

            margin-left: auto;

        }            position: sticky;            padding: 0;    <style>  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>G</text></svg>" />



        nav ul {            top: 0;

            display: flex;

            gap: 2rem;            z-index: 10;            display: flex;

            list-style: none;

        }        }



        nav a {            flex-direction: column;        body {  <style>

            color: #333;

            text-decoration: none;        .logo {

            font-weight: 500;

            transition: color 0.2s;            font-size: 28px;            height: 100vh;

        }

            font-weight: bold;

        nav a:hover {

            color: #0078d4;            margin-right: 10px;        }            margin: 0;    body {

        }

            color: #0078d4;

        main {

            flex: 1;            font-family: system-ui, sans-serif;

            padding: 1rem;

            max-width: 1200px;        }

            margin: 0 auto;

            width: 100%;        #topbar {            padding: 20px;      font-family: Arial, sans-serif;

            display: flex;

            flex-direction: column;        .title {

        }

            font-size: 22px;            display: flex;

        #placeholder {

            text-align: center;            font-weight: bold;

            color: #666;

            font-size: 1.5rem;            color: #333;            align-items: center;            font-family: Arial, sans-serif;      background: linear-gradient(to right, #e0f7fa, #e1bee7);

            margin: 2rem 0;

            font-style: italic;        }

            opacity: 1;

            transition: opacity 0.3s;            padding: 10px 20px;

        }

        nav {

        #chat {

            flex: 1;            margin-left: auto;            background-color: #ffffffcc;            background-color: #f0f0f0;      margin: 0;

            display: flex;

            flex-direction: column;        }

            gap: 1rem;

            margin-bottom: 1rem;            border-bottom: 1px solid #ccc;

        }

        nav ul {

        .message {

            max-width: 80%;            list-style: none;            position: sticky;        }      padding: 0;

            padding: 1rem;

            border-radius: 1rem;            display: flex;

            line-height: 1.5;

            animation: fadeIn 0.3s ease;            gap: 2rem;            top: 0;

            word-wrap: break-word;

            white-space: pre-wrap;            margin: 0;

        }

            padding: 0;            z-index: 10;      display: flex;

        @keyframes fadeIn {

            from { opacity: 0; transform: translateY(10px); }        }

            to { opacity: 1; transform: translateY(0); }

        }        }



        .user {        nav a {

            background: #0078d4;

            color: white;            color: #1e1e1e;        #chat-container {      flex-direction: column;

            align-self: flex-end;

            border-bottom-right-radius: 0.25rem;            font-weight: bold;

        }

            text-decoration: none;        .logo {

        .bot {

            background: white;        }

            color: #333;

            align-self: flex-start;            font-size: 28px;            max-width: 800px;      height: 100vh;

            border-bottom-left-radius: 0.25rem;

            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);        nav a:hover {

        }

            color: #0078d4;            font-weight: bold;

        .input-area {

            background: white;        }

            padding: 1rem;

            border-radius: 0.5rem;            margin-right: 10px;            margin: 0 auto;    }

            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

        }        #chat {



        .input-container {            flex: 1;            color: #0078d4;

            display: flex;

            gap: 0.5rem;            padding: 20px;

        }

            overflow-y: auto;            font-family: system-ui, sans-serif;            background-color: white;    header {

        #searchToggle {

            padding: 0.75rem;            display: flex;

            border-radius: 0.5rem;

            border: none;            flex-direction: column;        }

            background: #f0f0f0;

            color: #333;            gap: 10px;

            cursor: pointer;

            transition: all 0.2s;            max-width: 1200px;            border-radius: 10px;      display: flex;

            white-space: nowrap;

        }            margin: 0 auto;



        #searchToggle:hover {            width: 100%;        .title {

            background: #e0e0e0;

        }        }



        #searchToggle.active {            font-size: 22px;            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);      align-items: center;

            background: #0078d4;

            color: white;        .message {

        }

            max-width: 70%;            font-weight: bold;

        textarea {

            flex: 1;            margin-bottom: 16px;

            padding: 0.75rem;

            border: 1px solid #ddd;            padding: 10px 15px;            color: #333;            padding: 20px;      gap: 10px;

            border-radius: 0.5rem;

            font-family: inherit;            border-radius: 15px;

            font-size: 1rem;

            resize: none;            white-space: pre-wrap;        }

            min-height: 2.5rem;

            max-height: 150px;        }

            line-height: 1.5;

        }        }      padding: 10px 20px;



        textarea:focus {        .user {

            outline: none;

            border-color: #0078d4;            background-color: #0078d4;        nav {

        }

            color: white;

        button[type="submit"] {

            padding: 0.75rem 1.5rem;            align-self: flex-end;            margin-left: auto;      background-color: #fff;

            background: #0078d4;

            color: white;            border-bottom-right-radius: 0;

            border: none;

            border-radius: 0.5rem;        }        }

            cursor: pointer;

            font-weight: 500;

            transition: background 0.2s;

        }        .bot {        #chat-history {      border-bottom: 1px solid #ccc;



        button[type="submit"]:hover {            background-color: #f1f1f1;

            background: #006cbd;

        }            color: #333;        nav ul {



        #typing {            align-self: flex-start;

            color: #666;

            font-style: italic;            border-bottom-left-radius: 0;            list-style: none;            height: 400px;    }

            padding: 0.5rem 1rem;

            animation: fadeIn 0.3s ease;        }

        }

            display: flex;

        @media (max-width: 768px) {

            .message {        .input-area {

                max-width: 90%;

            }            padding: 10px;            gap: 2rem;            overflow-y: auto;    header img {



            nav ul {            background: #fff;

                gap: 1rem;

            }            border-top: 1px solid #ccc;            margin: 0;



            .title {        }

                font-size: 1rem;

            }            padding: 0;            border: 1px solid #ccc;      width: 24px;



            #searchToggle span {        .input-area > div {

                display: none;

            }            display: flex;        }

        }

    </style>            gap: 10px;

</head>

<body>            align-items: center;            padding: 10px;      height: 24px;

    <header id="topbar">

        <div class="logo" aria-hidden="true">G</div>            max-width: 1200px;

        <div class="title">Trợ lý ảo</div>

        <nav>            margin: 0 auto;        nav a {

            <ul>

                <li><a href="dksd.html">Điều khoản sử dụng</a></li>            padding: 0 10px;

                <li><a href="csbm.html">Chính sách bảo mật</a></li>

            </ul>        }            color: #1e1e1e;            margin-bottom: 20px;    }

        </nav>

    </header>



    <main>        textarea {            font-weight: bold;

        <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>

        <div id="chat"></div>            flex: 1;

        <div class="input-area">

            <div class="input-container">            resize: none;            text-decoration: none;            white-space: pre-wrap;    header h1 {

                <button id="searchToggle" title="Bật/tắt tìm kiếm">

                    🔍 <span>Tìm kiếm trên Internet</span>            padding: 10px;

                </button>

                <textarea             font-size: 16px;        }

                    id="question" 

                    placeholder="Nhập tin nhắn..."             border-radius: 8px;

                    rows="1"

                    onInput="this.style.height = ''; this.style.height = Math.min(this.scrollHeight, 150) + 'px'"            border: 1px solid #ccc;        }      font-size: 20px;

                ></textarea>

                <button type="submit" onclick="sendMessage()">Gửi</button>            font-family: inherit;

            </div>

        </div>            min-height: 40px;        nav a:hover {

    </main>

            max-height: 150px;

    <script>

        const chat = document.getElementById('chat');        }            color: #0078d4;      margin: 0;

        const input = document.getElementById('question');

        const searchToggle = document.getElementById('searchToggle');

        let internetMode = false;

        button {        }

        searchToggle.addEventListener('click', () => {

            internetMode = !internetMode;            padding: 10px 20px;

            searchToggle.classList.toggle('active');

        });            font-size: 16px;        #input-container {      color: #333;



        input.addEventListener('keydown', (event) => {            background-color: #0078d4;

            if (event.key === 'Enter' && !event.shiftKey) {

                event.preventDefault();            color: white;        #chat {

                sendMessage();

            }            border: none;

        });

            border-radius: 8px;            flex: 1;            display: flex;    }

        async function searchGoogle(question) {

            try {            cursor: pointer;

                const response = await fetch(`https://www.googleapis.com/customsearch/v1?key=AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE&cx=f5f83897432f243aa&q=${encodeURIComponent(question)}`);

                const data = await response.json();            transition: background-color 0.2s;            padding: 20px;

                

                if (data.items?.length > 0) {            white-space: nowrap;

                    return data.items.slice(0, 3).map(item => 

                        `• ${item.title}\n${item.snippet}\n${item.link}`        }            overflow-y: auto;            gap: 10px;    header a {

                    ).join('\n\n');

                }

                

                return 'Không tìm thấy thông tin trên Google.';        button:hover {        }

            } catch (error) {

                console.error('Google Search error:', error);            background-color: #006cbd;

                return '🛑 Không thể truy cập Google Search lúc này.';

            }        }        }      margin-left: auto;

        }



        async function sendMessage() {

            const question = input.value.trim();        #searchToggle.active {        .message {

            if (!question) return;

            background-color: #004578;

            // Add user message

            addMessage(question, 'user');        }            max-width: 70%;      font-size: 14px;

            

            // Clear input and placeholder

            input.value = '';

            input.style.height = 'auto';        #placeholder {            margin-bottom: 16px;

            document.getElementById('placeholder').style.opacity = '0';

            display: flex;

            showTyping();

            justify-content: center;            padding: 10px 15px;        #user-input {      color: #0078d4;

            try {

                let webInfo = '';            align-items: center;

                if (internetMode) {

                    updateTyping('Đang tìm kiếm trên Internet...');            color: #666;            border-radius: 15px;

                    webInfo = await searchGoogle(question);

                    addMessage('🔍 Kết quả từ Google:\n' + webInfo, 'bot');            margin: 40px 0;

                }

            font-style: italic;            white-space: pre-wrap;            flex-grow: 1;      text-decoration: none;

                updateTyping('Đang suy nghĩ...');

            font-size: 24px;

                const response = await fetch('https://aichat-v6nq.onrender.com/chat', {

                    method: 'POST',            opacity: 1;        }

                    headers: { 'Content-Type': 'application/json' },

                    body: JSON.stringify({            transition: opacity 0.8s ease;

                        message: internetMode

                            ? `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời dựa trên thông tin từ Google ở trên nếu liên quan.`        }            padding: 10px;    }

                            : question

                    })

                });

        #typing-indicator {        .user {

                if (!response.ok) {

                    throw new Error(`Lỗi server: ${response.status}`);            font-style: italic;

                }

            color: #666;            background-color: #0078d4;            border: 1px solid #ccc;    #chat {

                const data = await response.json();

                addMessage(data.response, 'bot');            align-self: flex-start;

            } catch (error) {

                console.error('Error:', error);            margin-bottom: 8px;            color: white;

                addMessage('❌ ' + error.message, 'bot');

            } finally {        }

                hideTyping();

            }            align-self: flex-end;            border-radius: 5px;      flex: 1;

        }

        @media (max-width: 768px) {

        function addMessage(text, type) {

            const message = document.createElement('div');            .message {            border-bottom-right-radius: 0;

            message.className = `message ${type}`;

            chat.appendChild(message);                max-width: 85%;



            if (type === 'bot') {            }            margin-left: auto;            font-size: 16px;      padding: 20px;

                typeText(message, text);

            } else {

                message.textContent = text;

            }            #searchToggle {        }



            chat.scrollTop = chat.scrollHeight;                padding: 10px;

        }

            }        }      overflow-y: auto;

        function typeText(element, text, speed = 30) {

            let i = 0;

            element.textContent = '';

                        .title {        .bot {

            const interval = setInterval(() => {

                if (i < text.length) {                font-size: 18px;

                    element.textContent += text[i];

                    i++;            }            background-color: #f1f1f1;    }

                    chat.scrollTop = chat.scrollHeight;

                } else {

                    clearInterval(interval);

                }            nav ul {            color: #333;

            }, speed);

        }                gap: 1rem;



        function showTyping() {            }            align-self: flex-start;        #send-button {    .message {

            if (!document.getElementById('typing')) {

                const typing = document.createElement('div');        }

                typing.id = 'typing';

                typing.textContent = 'Đang suy nghĩ...';    </style>            border-bottom-left-radius: 0;

                chat.appendChild(typing);

                chat.scrollTop = chat.scrollHeight;</head>

            }

        }<body>        }            padding: 10px 20px;      max-width: 70%;



        function updateTyping(text) {    <header id="topbar">

            const typing = document.getElementById('typing');

            if (typing) typing.textContent = text;        <div class="logo" aria-hidden="true">G</div>

        }

        <div class="title">Trợ lý ảo</div>

        function hideTyping() {

            const typing = document.getElementById('typing');        <nav>        .input-area {            background-color: #007bff;      margin-bottom: 16px;

            if (typing) typing.remove();

        }            <ul>

    </script>

</body>                <li><a href="dksd.html">Điều khoản sử dụng</a></li>            padding: 10px;

</html>
                <li><a href="csbm.html">Chính sách bảo mật</a></li>

            </ul>            background: #fff;            color: white;      padding: 10px 15px;

        </nav>

    </header>            border-top: 1px solid #ccc;



    <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>        }            border: none;      border-radius: 15px;

    <div id="chat"></div>



    <div class="input-area">

        <div>        .input-area > div {            border-radius: 5px;      white-space: pre-wrap;

            <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>

            <textarea             display: flex;

                id="question" 

                placeholder="Nhập tin nhắn..."             gap: 10px;            cursor: pointer;    }

                rows="1"

                oninput="this.style.height = '';this.style.height = Math.min(this.scrollHeight, 150) + 'px'"            align-items: center;

            ></textarea>

            <button onclick="sendMessage()">Gửi</button>            max-width: 1200px;            font-size: 16px;    .user {

        </div>

    </div>            margin: 0 auto;



    <script>        }        }      background-color: #0078d4;

        const chat = document.getElementById("chat");

        const input = document.getElementById("question");

        const searchToggle = document.getElementById("searchToggle");

        let internetMode = false;        textarea {      color: white;



        searchToggle.addEventListener("click", () => {            flex: 1;

            internetMode = !internetMode;

            searchToggle.classList.toggle("active", internetMode);            resize: none;        #send-button:hover {      align-self: flex-end;

        });

            padding: 10px;

        input.addEventListener("keydown", function(event) {

            if (event.key === "Enter" && !event.shiftKey) {            font-size: 16px;            background-color: #0056b3;      border-bottom-right-radius: 0;

                event.preventDefault();

                sendMessage();            border-radius: 8px;

            }

        });            border: 1px solid #ccc;        }    }



        async function searchGoogle(question) {            font-family: inherit;

            const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";

            const cx = "f5f83897432f243aa";        }    .bot {

            const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;



            try {

                const res = await fetch(url);        button {        .user-message {      background-color: #f1f1f1;

                const data = await res.json();

                if (data.items && data.items.length > 0) {            padding: 10px 20px;

                    return data.items.slice(0, 3).map(item =>

                        `• ${item.title}\n${item.snippet}\n${item.link}`            font-size: 16px;            color: #007bff;      color: #333;

                    ).join("\n\n");

                } else {            background-color: #0078d4;

                    return "Không tìm thấy thông tin trên Google.";

                }            color: white;            margin-bottom: 10px;      align-self: flex-start;

            } catch (err) {

                return "🛑 Không thể truy cập Google Search lúc này.";            border: none;

            }

        }            border-radius: 8px;        }      border-bottom-left-radius: 0;



        async function sendMessage() {            cursor: pointer;

            const question = input.value.trim();

            if (!question) return;            transition: background-color 0.2s;    }



            addMessage(question, "user");        }

            document.getElementById("placeholder").style.opacity = "0";

            input.value = "";        .ai-message {    .input-area {

            input.style.height = "auto";

        button:hover {

            showTypingIndicator();

            background-color: #006cbd;            color: #28a745;      padding: 10px;

            const shouldSearch = internetMode;

            let webInfo = "";        }



            if (shouldSearch) {            margin-bottom: 10px;      background: #fff;

                updateTypingIndicator("Đang tìm kiếm trên Google...");

                webInfo = await searchGoogle(question);        #searchToggle.active {

                addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");

            }            background-color: #004578;        }      border-top: 1px solid #ccc;



            try {        }

                const response = await fetch("https://aichat-v6nq.onrender.com/chat", {

                    method: "POST",    }

                    headers: { "Content-Type": "application/json" },

                    body: JSON.stringify({        #placeholder {

                        message: shouldSearch 

                            ? `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời dựa trên thông tin từ Google ở trên nếu liên quan.`            display: flex;        #thinking-indicator {    .input-area > div {

                            : question

                    })            justify-content: center;

                });

            align-items: center;            display: none;      display: flex;

                if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

            height: 100px;

                const result = await response.json();

                hideTypingIndicator();            text-align: center;            color: #666;      gap: 10px;

                addMessage(result.response, "bot");

            } catch (error) {            color: #666;

                console.error("🛑 Lỗi khi gọi API:", error);

                hideTypingIndicator();            margin-top: 40px;            margin-top: 10px;      align-items: center;

                addMessage("🛑 Có lỗi xảy ra: " + error.message, "bot");

            }            font-style: italic;

        }

            font-size: 40px;        }    }

        function addMessage(text, sender) {

            const msg = document.createElement("div");            font-weight: bold;

            msg.className = `message ${sender}`;

            chat.appendChild(msg);            opacity: 1;    </style>    textarea {



            if (sender === "bot") {            transition: opacity 0.8s ease;

                typeText(msg, text);

            } else {        }</head>      flex: 1;

                msg.textContent = text;

            }



            chat.scrollTop = chat.scrollHeight;        #typing-indicator {<body>      resize: none;

        }

            font-style: italic;

        function typeText(element, text, speed = 5) {

            let i = 0;            color: #666;    <div id="chat-container">      padding: 10px;

            element.textContent = "";

            const interval = setInterval(() => {        }

                if (i < text.length) {

                    element.textContent += text.charAt(i);    </style>        <div id="chat-history">      font-size: 16px;

                    i++;

                    chat.scrollTop = chat.scrollHeight;</head>

                } else {

                    clearInterval(interval);<body>            <!-- Tin nhắn sẽ được hiển thị ở đây -->      border-radius: 8px;

                }

            }, speed);    <header id="topbar">

        }

        <div class="logo" aria-hidden="true">G</div>        </div>      border: 1px solid #ccc;

        function showTypingIndicator() {

            const typing = document.createElement("div");        <div class="title">Trợ lý ảo</div>

            typing.id = "typing-indicator";

            typing.className = "message bot";        <nav>        <div id="input-container">    }

            typing.textContent = "Trợ lý ảo đang gõ...";

            chat.appendChild(typing);            <ul>

            chat.scrollTop = chat.scrollHeight;

        }                <li><a href="dksd.html">Điều khoản sử dụng</a></li>            <input type="text" id="user-input" placeholder="Nhập tin nhắn của bạn...">    button {



        function updateTypingIndicator(text) {                <li><a href="csbm.html">Chính sách bảo mật</a></li>

            const typing = document.getElementById("typing-indicator");

            if (typing) typing.textContent = text;            </ul>            <button id="send-button">Gửi</button>      padding: 10px 20px;

        }

        </nav>

        function hideTypingIndicator() {

            const typing = document.getElementById("typing-indicator");    </header>        </div>      font-size: 16px;

            if (typing) typing.remove();

        }

    </script>

</body>    <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>        <div id="thinking-indicator">AI đang suy nghĩ...</div>      background-color: #0078d4;

</html>
    <div id="chat"></div>

    <div class="input-area">    </div>      color: white;

        <div>

            <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>      border: none;

            <textarea id="question" placeholder="Nhập tin nhắn..." rows="1"></textarea>

            <button onclick="sendMessage()">Gửi</button>    <script>      border-radius: 8px;

        </div>

    </div>        const chatHistory = document.getElementById('chat-history');      cursor: pointer;



    <script>        const userInput = document.getElementById('user-input');    }

        const chat = document.getElementById("chat");

        const input = document.getElementById("question");        const sendButton = document.getElementById('send-button');    #searchToggle.active {

        const searchToggle = document.getElementById("searchToggle");

        let internetMode = false;        const thinkingIndicator = document.getElementById('thinking-indicator');      background-color: #000;



        // Auto-resize textarea as user types      color: #fff;

        input.addEventListener('input', function() {

            this.style.height = 'auto';        let isProcessing = false;    }

            this.style.height = Math.min(this.scrollHeight, 150) + 'px';

        });    #placeholder {



        searchToggle.addEventListener("click", () => {        async function sendMessage() {      display: flex;

            internetMode = !internetMode;

            searchToggle.classList.toggle("active", internetMode);            if (isProcessing || !userInput.value.trim()) return;      justify-content: center;

        });

      align-items: center;

        input.addEventListener("keydown", function(event) {

            if (event.key === "Enter" && !event.shiftKey) {            const userMessage = userInput.value.trim();      height: 100px;

                event.preventDefault();

                sendMessage();            appendMessage('Người dùng: ' + userMessage, 'user-message');      text-align: center;

            }

        });            userInput.value = '';      color: #666;



        async function searchGoogle(question) {      margin-top: 40px;

            const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";

            const cx = "f5f83897432f243aa";            isProcessing = true;      font-style: italic;

            const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;

            thinkingIndicator.style.display = 'block';      font-size: 40px;

            try {

                const res = await fetch(url);      font-weight: bold;

                const data = await res.json();

                if (data.items && data.items.length > 0) {            try {      opacity: 1;

                    return data.items.slice(0, 3).map(item =>

                        `• ${item.title}\n${item.snippet}\n${item.link}`                const response = await fetch('https://aichat-v6nq.onrender.com/chat', {      transition: opacity 0.8s ease;

                    ).join("\n\n");

                } else {                    method: 'POST',    }

                    return "Không tìm thấy thông tin trên Google.";

                }                    headers: {    #topbar {

            } catch (err) {

                return "🛑 Không thể truy cập Google Search lúc này.";                        'Content-Type': 'application/json'  display: flex;

            }

        }                    },  align-items: center;



        async function sendMessage() {                    body: JSON.stringify({ message: userMessage })  padding: 10px 20px;

            const question = input.value.trim();

            if (!question) return;                });  background-color: #ffffffcc;



            addMessage(question, "user");  border-bottom: 1px solid #ccc;

            document.getElementById("placeholder").style.opacity = "0";

            input.value = "";                const data = await response.json();  position: sticky;

            input.style.height = 'auto';

                appendMessage('AI: ' + data.response, 'ai-message');  top: 0;

            showTypingIndicator();

            } catch (error) {  z-index: 10;

            const shouldSearch = internetMode;

            let webInfo = "";                console.error('Error:', error);}



            if (shouldSearch) {                appendMessage('AI: Xin lỗi, đã có lỗi xảy ra. Vui lòng thử lại sau.', 'ai-message');

                updateTypingIndicator("Đang tìm kiếm trên Google...");

                webInfo = await searchGoogle(question);            }.logo {

                addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");

            }  font-size: 28px;



            try {            isProcessing = false;  font-weight: bold;

                const response = await fetch("https://aichat-v6nq.onrender.com/chat", {

                    method: "POST",            thinkingIndicator.style.display = 'none';  margin-right: 10px;

                    headers: { "Content-Type": "application/json" },

                    body: JSON.stringify({        }  color: #0078d4;

                        message: shouldSearch 

                            ? `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời dựa trên thông tin từ Google ở trên nếu liên quan.`  font-family: system-ui, sans-serif;

                            : question

                    })        function appendMessage(message, className) {}

                });

            const messageElement = document.createElement('div');

                if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

            messageElement.textContent = message;.title {

                const result = await response.json();

                hideTypingIndicator();            messageElement.className = className;  font-size: 22px;

                addMessage(result.response, "bot");

            } catch (error) {            chatHistory.appendChild(messageElement);  font-weight: bold;

                console.error("🛑 Lỗi khi gọi API:", error);

                hideTypingIndicator();            chatHistory.scrollTop = chatHistory.scrollHeight;  color: #333;

                addMessage("🛑 Có lỗi xảy ra: " + error.message, "bot");

            }        }}

        }

nav{

        function addMessage(text, sender) {

            const msg = document.createElement("div");        sendButton.addEventListener('click', sendMessage);  letter-spacing: 1px;

            msg.className = `message ${sender}`;

            chat.appendChild(msg);        userInput.addEventListener('keypress', (e) => {  padding: 1rem;



            if (sender === "bot") {            if (e.key === 'Enter') {}

                typeText(msg, text);

            } else {                sendMessage();

                msg.textContent = text;

            }            }nav ul{



            chat.scrollTop = chat.scrollHeight;        });  list-style: none;

        }

    </script>  display: flex;

        function typeText(element, text, speed = 5) {

            let i = 0;</body>  justify-content: center;

            const interval = setInterval(() => {

                if (i < text.length) {</html>  gap: 2rem;

                    element.textContent += text.charAt(i);}

                    i++;

                    chat.scrollTop = chat.scrollHeight;nav a{

                } else {  color: #1e1e1e;

                    clearInterval(interval);  font-weight: bold;

                }}

            }, speed);

        }nav a:hover{

  color: #ffd700;

        function showTypingIndicator() {}

            const typing = document.createElement("div");

            typing.id = "typing-indicator";  </style>

            typing.className = "message bot";</head>

            typing.textContent = "Trợ lý ảo đang gõ...";<body>

            chat.appendChild(typing);  <header id="topbar">

            chat.scrollTop = chat.scrollHeight;  <div class="logo" aria-hidden="true">G</div>

        }  <div class="title">Trợ lý ảo</div>

  <nav>

        function updateTypingIndicator(text) {    <ul>

            const typing = document.getElementById("typing-indicator");         <li><a href="dksd.html">Điều khoản sử dụng</a></li>

            if (typing) typing.textContent = text;         <li><a href="csbm.html">Chính sách bảo mật</a></li>

        }    </ul>

  </nav>

        function hideTypingIndicator() {</header>

            const typing = document.getElementById("typing-indicator");

            if (typing) typing.remove();  <div id="placeholder">Bạn đang nghĩ gì thế? Chia sẻ cho tớ với...</div>

        }  <div id="chat"></div>

    </script>  <div class="input-area">

</body>    <div>

</html>      <button id="searchToggle">🔍 Tìm kiếm trên Internet</button>
      <textarea id="question" placeholder="Nhập tin nhắn..."></textarea>
      <button onclick="sendMessage()">Gửi</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("question");
    const searchToggle = document.getElementById("searchToggle");
    let internetMode = false;

    searchToggle.addEventListener("click", () => {
      internetMode = !internetMode;
      searchToggle.classList.toggle("active", internetMode);
    });

    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    });

    async function searchGoogle(question) {
      const apiKey = "AIzaSyCLd8SgROMIM2479M2ZgQ5AEdgjcE-4PLE";
      const cx = "f5f83897432f243aa";
      const url = `https://www.googleapis.com/customsearch/v1?key=${apiKey}&cx=${cx}&q=${encodeURIComponent(question)}`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.items && data.items.length > 0) {
          return data.items.slice(0, 3).map(item =>
            `â€¢ ${item.title}\n${item.snippet}\n${item.link}`
          ).join("\n\n");
        } else {
          return "Không tìm thấy thông tin trên Google.";
        }
      } catch (err) {
        return "🛑 Không thể truy cập Google Search lúc này.";
      }
    }

    async function sendMessage() {
      const question = input.value.trim();
      if (!question) return;

      addMessage(question, "user");
      document.getElementById("placeholder").style.opacity = "0";
      input.value = "";

      showTypingIndicator();

      const shouldSearch = internetMode;
      let webInfo = "";

      if (shouldSearch) {
        updateTypingIndicator("Đang tìm kiếm trên Google...");
        webInfo = await searchGoogle(question);
        addMessage("🕵️‍♂️ Kết quả từ Google:\n" + webInfo, "bot");
      }

      const messages = [
        {
          role: "system",
          content: "Bạn là trợ lý AI thân thiện, nói chuyện tự nhiên như người thật. Ưu tiên dùng thông tin từ Google nếu có."
        },
        {
          role: "user",
          content: `Thông tin từ Google:\n${webInfo}\n\nCâu hỏi: ${question}\n\nHãy trả lời chính xác dựa trên thông tin từ Google ở trên. Nếu có tên người, chức vụ hoặc ngày tháng, hãy trích dẫn lại.`
        }
      ];

      try {
        const response = await fetch("https://website-chat-8hyf.onrender.com/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ messages })
        });

        if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

        const result = await response.json();
        const reply = result.choices?.[0]?.message?.content || "Không có phản hồi từ Groq.";

        hideTypingIndicator();
        addMessage(reply, "bot");
      } catch (error) {
        console.error("🛑 Lỗi khi gọi API:", error);
        hideTypingIndicator();
        addMessage("🛑 Có lỗi xảy ra khi gọi Groq: " + error.message, "bot");
      }
    }

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.className = `message ${sender}`;
      chat.appendChild(msg);

      if (sender === "bot") {
        typeText(msg, text);
      } else {
        msg.textContent = text;
      }

      chat.scrollTop = chat.scrollHeight;
    }

    function typeText(element, text, speed = 5) {
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          chat.scrollTop = chat.scrollHeight;
        } else {
          clearInterval(interval);
        }
      }, speed);
    }

    function showTypingIndicator() {
      const typing = document.createElement("div");
      typing.id = "typing-indicator";
      typing.className = "message bot";
      typing.textContent = "Trợ lý ảo đang gõ...";
      chat.appendChild(typing);
      chat.scrollTop = chat.scrollHeight;
    }

    function updateTypingIndicator(text) {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.textContent = text;
    }

    function hideTypingIndicator() {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.remove();
    }
  </script>
</body>
</html>
